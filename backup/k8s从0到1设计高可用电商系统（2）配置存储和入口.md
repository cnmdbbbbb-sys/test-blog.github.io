# 配置存储（让数据库有地方存数据）和 配置入口（能访问网页）。

## 第一步：安装本地存储插件 (StorageClass)
这是必须要做的，否则后续部署 MySQL、Redis 和 Prometheus 时，PVC 会一直卡在 Pending 状态。

1. 安装 Rancher Local Path Provisioner

`kubectl apply -f https://raw.githubusercontent.com/rancher/local-path-provisioner/v0.0.24/deploy/local-path-storage.yaml`
2. 将其设为默认存储类 (关键) 这样以后你不必每次都指定 StorageClass 的名字。

`kubectl patch storageclass local-path -p '{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}'`
3. 验证

`kubectl get sc`

## 第二步：安装 Ingress 控制器 (流量入口)
需要 Ingress Nginx 来管理外部访问。由于是本地环境，使用兼容性最好的 baremetal 版本。

1. 安装 Ingress-Nginx Controller

`kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.2/deploy/static/provider/baremetal/deploy.yaml`
2. 验证 Pod 启动

`kubectl get pods -n ingress-nginx`


第三步：为项目创建专属空间
为了不污染系统环境，我们把电商项目都放在独立的 Namespace 里。

`kubectl create namespace ecommerce`
✅ 阶段性检查
预期输出：应看到 local-path (default)。
预期输出：需要等待一会儿，直到 ingress-nginx-controller 变为 Running。
一旦确认无误，就可以直接部署数据库了！
```
kubectl get sc
kubectl get pods -n ingress-nginx
```